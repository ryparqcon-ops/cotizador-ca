<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Casa Austin">
    <title>Casa Austin - Consulta de Disponibilidad</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/daterangepicker.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h2 class="text-center">Consulta de Disponibilidad</h2>
        <div class="row">
            <div class="col-12 col-md-8 offset-md-2 col-lg-6 offset-lg-3">
                <div class="form-group">
                    <label for="fechas">Seleccione un rango de fechas:</label>
                    <input type="text" class="form-control" id="fechas" name="fechas" autocomplete="off">
                </div>
                <div class="form-group">
                    <label for="estiloMensaje">Estilo del Mensaje:</label>
                    <select id="estiloMensaje" class="form-control">
                        <option value="1">Premium</option>
                        <option value="2">Urgencia</option>
                        <option value="3">Emocional</option>
                        <option value="4">Valor</option>
                        <option value="5">Simple</option>
                    </select>
                    <div id="descripcionEstilo" style="margin-top:8px; font-size:0.95em; color:#555;"></div>
                </div>
                <div id="input-container">
                    <div class="input-group">
                        <label for="personas">N° de personas:</label>
                        <input type="number" id="personas" name="personas" class="custom-input" min="1" value="2">
                    </div>
                    <div class="input-group">
                        <label for="tipoCambio">T.C:</label>
                        <input type="number" id="tipoCambio" name="tipoCambio" step="0.01" class="custom-input" value="3.6">
                    </div>
                </div>
                <div class="form-group">
                    <label>Tipo de Descuento (opcional):</label>
                    <div class="form-check-container">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="aplicarDescuentoBase" value="base">
                            <label class="form-check-label" for="aplicarDescuentoBase">Descuento Base</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="aplicarDescuentoTotal" value="total">
                            <label class="form-check-label" for="aplicarDescuentoTotal">Descuento Total</label>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="descuento-consultar-container">
                        <div class="descuento-input">
                            <label for="porcentajeDescuento">% de Descuento:</label>
                            <input type="number" id="porcentajeDescuento" name="porcentajeDescuento" step="0.01" class="custom-input" min="0">
                        </div>
                        <div class="consultar-btn">
                            <button class="btn btn-primary" id="btnConsultar">Consultar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-center mt-4">
            <img class="loading" src="assets/loading.gif" alt="Cargando...">
        </div>
        <div class="text-center mt-4" id="resultadoContainer">
            <h4>Resultado:</h4>
            <textarea id="textoResultado" class="form-control" rows="10" readonly></textarea>
            <button class="btn btn-primary mt-3" id="btnCopiar">Copiar Resultado</button>
        </div>
    </div>
    
    <!-- Botón flotante fijo -->
    <button class="btn-flotante-fijo" id="btnCopiarFlotante" title="Copiar resultado" style="display: none;">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
        </svg>
    </button>
    </div>
    <script src="assets/jquery-3.5.1.min.js"></script>
    <script src="assets/moment.min.js"></script>
    <script src="assets/es.min.js"></script>
    <script src="assets/daterangepicker.min.js"></script>
    
    <script>
        // Registrar Service Worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('SW registrado exitosamente:', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW falló al registrarse:', registrationError);
                    });
            });
        }

        // Mostrar prompt de instalación PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Mostrar botón de instalación
            const installBtn = document.createElement('button');
            installBtn.innerHTML = '📱 Instalar App';
            installBtn.className = 'btn btn-success btn-block';
            installBtn.style.marginTop = '10px';
            installBtn.onclick = () => {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('Usuario aceptó la instalación');
                    }
                    deferredPrompt = null;
                });
            };
            document.querySelector('.container .row').appendChild(installBtn);
        });

        // Detectar si la app está instalada
        window.addEventListener('appinstalled', (evt) => {
            console.log('App instalada exitosamente');
            // Ocultar botón de instalación
            const installBtn = document.querySelector('button[onclick*="deferredPrompt"]');
            if (installBtn) {
                installBtn.style.display = 'none';
            }
        });
    </script>
    
    <script>
        $(document).ready(function () {
            moment.locale('es');
            $('#fechas').daterangepicker({
                startDate: moment(),
                endDate: moment().add(1, 'days'),
                minDate: moment(),
                locale: {
                    format: 'YYYY-MM-DD',
                    applyLabel: 'Aplicar',
                    cancelLabel: 'Cancelar',
                    daysOfWeek: ['Dom', 'Lun', 'Mar', 'Mie', 'Jue', 'Vie', 'Sab'],
                    monthNames: ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio', 'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre']
                }
            });

            // Descripciones de los estilos
            const descripciones = {
                "1": "✨ Premium: Mensaje aspiracional, experiencia exclusiva y emocional.",
                "2": "🔥 Urgencia: Crea escasez y motiva a reservar rápido.",
                "3": "🌅 Emocional: Enfocado en familia, descanso y recuerdos.",
                "4": "🎯 Valor: Resalta beneficios racionales y seguridad.",
                "5": "📆 Simple: Directo, claro y fácil de copiar para WhatsApp."
            };
            function actualizarDescripcionEstilo() {
                const val = $('#estiloMensaje').val();
                $('#descripcionEstilo').text(descripciones[val]);
            }
            $('#estiloMensaje').on('change', actualizarDescripcionEstilo);
            actualizarDescripcionEstilo();

            // Botón consultar
            $('#btnConsultar').on('click', function () {
                consultaDisponibilidad();
            });

            // Botón copiar
            $('#btnCopiar').on('click', function () {
                copiarResultado();
            });

            // Botón copiar flotante
            $('#btnCopiarFlotante').on('click', function () {
                copiarResultado();
            });
        });

        async function consultaDisponibilidad() {
            const fechas = $('#fechas').val().split(' - ');
            const fechaInicio = fechas[0];
            const fechaFin = fechas[1];
            let numPersonas = parseInt($('#personas').val());
            const tipoCambio = parseFloat($('#tipoCambio').val());
            const aplicarDescuentoBase = $('#aplicarDescuentoBase').is(':checked');
            const aplicarDescuentoTotal = $('#aplicarDescuentoTotal').is(':checked');
            let porcentajeDescuento = parseFloat($('#porcentajeDescuento').val());
            const estiloMensaje = $('#estiloMensaje').val();

            if ((aplicarDescuentoBase || aplicarDescuentoTotal) && (isNaN(porcentajeDescuento) || porcentajeDescuento <= 0)) {
                alert('Por favor, ingresa un porcentaje de descuento válido.');
                return;
            }
            if (isNaN(numPersonas) || numPersonas < 1) numPersonas = 1;
            if (isNaN(tipoCambio)) {
                alert('Por favor, ingresa un tipo de cambio válido.');
                return;
            }

            $('.loading').show();
            $('#resultadoContainer').hide();
            $('#btnCopiarFlotante').hide();

            const data = {
                start_date: fechaInicio,
                end_date: fechaFin,
                num_personas: numPersonas,
                tipo_cambio: tipoCambio
            };
            if (aplicarDescuentoBase) data.dsct_base = porcentajeDescuento;
            if (aplicarDescuentoTotal) data.dsct_total = porcentajeDescuento;

            try {
                // Consumir el API real
                const params = new URLSearchParams({
                    start_date: data.start_date,
                    end_date: data.end_date,
                    num_personas: data.num_personas,
                    tipo_cambio: data.tipo_cambio,
                    detalles_disponibilidad: 1,
                    _t: Date.now()
                });
                
                const response = await fetch(`https://casaaustin.pe/api/landing-precios.php?${params}`);
                
                const responseData = await response.json();
                console.log('Respuesta del API:', responseData);
                $('.loading').hide();

                if (responseData.error) {
                    $('#textoResultado').val('Hubo un error: ' + responseData.error);
                    $('#resultadoContainer').show();
                    return;
                }

                let respObj = responseData;
                const resultadoContainer = $('#resultadoContainer');
                const resultadoTexto = $('#textoResultado');
                const btnFlotante = $('#btnCopiarFlotante');
                resultadoTexto.val('');
                const startDateFormatted = moment(fechaInicio).format('dddd D');
                const endDateFormatted = moment(fechaFin).format('dddd D [de] MMMM');
                let mensaje = "";
                let precios = respObj.message2 ? respObj.message2.trim() : "";
                const fotosLink = `https://casaaustin.pe/disponibilidad?checkIn=${fechaInicio}&checkOut=${fechaFin}`;

                let casa1Disponible = false;
                if (Array.isArray(respObj.casasDisponibles)) {
                    casa1Disponible = respObj.casasDisponibles.some(
                        casa => casa.idCasa === 1
                    );
                }

                // Verificar si las fechas son de lunes a jueves y el mes es de mayo a noviembre
                const startMoment = moment(fechaInicio, 'YYYY-MM-DD');
                const endMoment = moment(fechaFin, 'YYYY-MM-DD');
                const esLunesAJueves = startMoment.day() >= 1 && startMoment.day() <= 4 && endMoment.day() >= 1 && endMoment.day() <= 4;
                const esMesMayoANoviembre = (startMoment.month() + 1) >= 5 && (startMoment.month() + 1) <= 11;
                const mostrarDatoClaveCasa1 = false; // Deshabilitado según solicitud

                let leyendaDescuento = "";
                if (aplicarDescuentoBase) {
                    leyendaDescuento = ` con ${porcentajeDescuento}% de descuento en el precio base`;
                }
                if (aplicarDescuentoTotal) {
                    leyendaDescuento = ` con ${porcentajeDescuento}% de descuento en el precio total`;
                }

                // Verificar disponibilidad primero - solo considerar disponible si es 1 (disponibilidad completa)
                if (respObj.estadoDisponibilidad === 1) {
                    // Generar mensaje según el estilo seleccionado solo si hay disponibilidad
                    switch (estiloMensaje) {
                        case "1": // Premium Experiencial
                            mensaje = `🏖️ *¡CONFIRMADO! UNA ESCAPADA PREMIUM TE ESPERA*\n📅 *Del ${startDateFormatted} al ${endDateFormatted}*\n\n✨ *${respObj.totalCasasDisponibles} casas disponibles para quienes valoran comodidad, privacidad y estilo*\n\n💵 *Tarifas para ${numPersonas} personas${leyendaDescuento}:*\n${precios}\n\n📍 *Playa Los Pulpos – A solo 20 minutos del Jockey Plaza*\n🕒 *Check-in: 3:00 PM | 🕚 Check-out: 11:00 AM*\n\n📸 *Reserva aquí →* ${fotosLink}\n\n🎁 *Beneficios exclusivos por reservar en nuestra web:*\n• 5% de puntos en cada reserva\n• Beneficios especiales para miembros de Casa Austin\n• Atención personalizada\n\n🌊 *Asegura tu estadía hoy mismo y disfruta de una experiencia exclusiva junto al mar.*`;
                            break;
                        case "2": // Urgencia y Escasez
                            mensaje = `🔥 *¡ÚLTIMAS ${respObj.totalCasasDisponibles} CASAS DISPONIBLES!*\n📅 *${startDateFormatted} al ${endDateFormatted}*\n\n⚡ *Reservas volando. Este bloque de fechas está por agotarse.*\n\n💵 *Precios para ${numPersonas} personas${leyendaDescuento}:*\n${precios}\n\n🚩 *¿Por qué alquilar con nosotros?*\n✔️ Casas totalmente independientes\n✔️ Ubicación privilegiada en Los Pulpos\n✔️ Privacidad garantizada – nada compartido\n✔️ A solo 20 minutos de Lima\n\n🕒 *Entrada: 3:00 PM | Salida: 11:00 AM*\n📱 *Reserva aquí →* ${fotosLink}\n\n🎁 *Beneficios exclusivos por reservar en nuestra web:*\n• 5% de puntos en cada reserva\n• Beneficios especiales para miembros de Casa Austin\n• Atención personalizada\n\n🧭 *Reserva ahora y evita quedarte sin disponibilidad.*`;
                            break;
                        case "3": // Emocional y Familiar
                            mensaje = `🌅 *¡VIVE MOMENTOS INOLVIDABLES EN LA PLAYA!*\n📅 *Del ${startDateFormatted} al ${endDateFormatted}*\n\n🏠 *Tenemos ${respObj.totalCasasDisponibles} casas listas para recibirte*\nPerfectas para desconectarte, reconectar o simplemente descansar.\n\n💵 *Para ${numPersonas} personas${leyendaDescuento}:*\n${precios}\n\n📍 *Ubicación: Playa Los Pulpos (a solo 20 minutos del Jockey)*\n🌊 *Acceso cercano al mar • Casas privadas • Ambiente seguro*\n\n🕒 *Check-in: 3:00 PM | Check-out: 11:00 AM*\n📸 *Reserva aquí →* ${fotosLink}\n\n🎁 *Beneficios exclusivos por reservar en nuestra web:*\n• 5% de puntos en cada reserva\n• Beneficios especiales para miembros de Casa Austin\n• Atención personalizada\n\n💬 *Regálate un descanso. Tu playa, tu espacio, tu momento.*`;
                            break;
                        case "4": // Racional y Valor Percibido
                            mensaje = `🎯 *DISPONIBILIDAD VERIFICADA: ¡ALQUILA CON CONFIANZA!*\n📅 *${startDateFormatted} al ${endDateFormatted}*\n\n🔐 *${respObj.totalCasasDisponibles} casas privadas para tu escapada perfecta*\n\n💰 *Tarifas para ${numPersonas} personas${leyendaDescuento}:*\n${precios}\n\n🎁 *¿Qué obtienes al alquilar?*\n• Casa 100% privada (nada compartido)\n• Fácil acceso desde Lima (20 minutos del Jockey)\n• Atención personalizada\n• Zona segura y familiar\n\n🕒 *Check-in: 3:00 PM | Check-out: 11:00 AM*\n📱 *Reserva aquí →* ${fotosLink}\n\n🎁 *Beneficios exclusivos por reservar en nuestra web:*\n• 5% de puntos en cada reserva\n• Beneficios especiales para miembros de Casa Austin\n• Atención personalizada\n\n📌 *Aprovecha esta opción cómoda, segura y rentable para descansar.*`;
                            break;
                        case "5": // Simplicidad, Claridad y Acción Directa
                        default:
                            mensaje = `📆 *DISPONIBILIDAD: ${startDateFormatted} al ${endDateFormatted}*\n🏡 *${respObj.totalCasasDisponibles} casas en Playa Los Pulpos listas para ti*\n\n💵 *Tarifas (${numPersonas} personas${leyendaDescuento}):*\n${precios}\n\n📍 *Ubicación: Playa Los Pulpos – A 20 min del Jockey Plaza*\n🕒 *Check-in: 3:00 PM | Check-out: 11:00 AM*\n\n📸 *Reserva aquí →* ${fotosLink}\n\n🎁 *Beneficios exclusivos por reservar en nuestra web:*\n• 5% de puntos en cada reserva\n• Beneficios especiales para miembros de Casa Austin\n• Atención personalizada\n\n🎯 *Haz clic y asegura tu casa ahora mismo.*`;
                            break;
                    }
                }

                if (respObj.estadoDisponibilidad === 1) {
                    resultadoContainer.show();
                    btnFlotante.show();
                    
                    resultadoTexto.val(mensaje);
                    
                    // Agregar texto final solo si hay disponibilidad
                    const textoFinal = "\nCada casa es independiente y de uso exclusivo para tu reserva. Todas nuestras casas están ubicadas en la playa Los Pulpos, a 20 minutos del Jockey Plaza.\n\n*IMPORTANTE: En Casa Austin, consideramos persona adicional a cualquier visitante, sin distinción si es por el día o la noche. Por favor, asegúrate de indicar el número exacto de personas que ingresarán a la casa.*\n\n*HORARIO: Ingreso desde las 3 p.m. y salida es hasta las 11 a.m.*";
                    resultadoTexto.val(resultadoTexto.val() + textoFinal);
                } else {
                    // Si no hay disponibilidad, verificar fechas alternativas directamente
                    await verificarFechasAlternativas(fechaInicio, fechaFin, numPersonas, tipoCambio, estiloMensaje, fotosLink);
                }

            } catch (err) {
                $('.loading').hide();
                $('#textoResultado').val('Hubo un error al consultar la disponibilidad. Por favor, inténtalo de nuevo.');
                $('#resultadoContainer').show();
            }
        }

        async function verificarFechasAlternativas(fechaInicio, fechaFin, numPersonas, tipoCambio, estiloMensaje, fotosLink) {
            try {
                // Calcular fechas alternativas manteniendo el mismo rango de fechas
                const fechaInicioMoment = moment(fechaInicio, 'YYYY-MM-DD');
                const fechaFinMoment = moment(fechaFin, 'YYYY-MM-DD');
                
                // Calcular número de noches del rango original
                const numeroNoches = fechaFinMoment.diff(fechaInicioMoment, 'days');
                
                // Generar solo 1 fecha antes y 1 fecha después
                const alternativas = [];
                
                // Fecha anterior (1 día antes)
                const fechaAnteriorInicio = fechaInicioMoment.clone().subtract(1, 'day').format('YYYY-MM-DD');
                const fechaAnteriorFin = fechaInicioMoment.clone().subtract(1, 'day').add(numeroNoches, 'days').format('YYYY-MM-DD');
                
                // Fecha posterior (1 día después)
                const fechaPosteriorInicio = fechaInicioMoment.clone().add(1, 'day').format('YYYY-MM-DD');
                const fechaPosteriorFin = fechaInicioMoment.clone().add(1, 'day').add(numeroNoches, 'days').format('YYYY-MM-DD');
                
                // Verificar disponibilidad para fecha anterior
                const dataAnterior = {
                    start_date: fechaAnteriorInicio,
                    end_date: fechaAnteriorFin,
                    num_personas: numPersonas,
                    tipo_cambio: tipoCambio,
                    detalles_disponibilidad: 1
                };
                
                const responseAnterior = await fetch('https://casaaustin.pe/api/landing-precios.php?' + new URLSearchParams({
                    ...dataAnterior,
                    _t: Date.now()
                }));
                const respAnterior = await responseAnterior.json();
                
                if (respAnterior.estadoDisponibilidad === 1) {
                    const preciosAnterior = respAnterior.message2 ? respAnterior.message2.trim() : "";
                    const preciosConvertidos = preciosAnterior.replace(/\$(\d+)\s*USD/g, (match, precioUSD) => {
                        const precioSoles = Math.round(parseInt(precioUSD) * tipoCambio);
                        return `Casa ${precioUSD === '65' ? '1' : precioUSD === '85' ? '2' : '3'}: $${precioUSD} Dólares ó S/.${precioSoles}.00 Soles`;
                    });
                    
                    alternativas.push({
                        fechaInicio: fechaAnteriorInicio,
                        fechaFin: fechaAnteriorFin,
                        precios: preciosConvertidos,
                        tipo: 'anterior'
                    });
                }
                
                // Verificar disponibilidad para fecha posterior
                const dataPosterior = {
                    start_date: fechaPosteriorInicio,
                    end_date: fechaPosteriorFin,
                    num_personas: numPersonas,
                    tipo_cambio: tipoCambio,
                    detalles_disponibilidad: 1
                };
                
                const responsePosterior = await fetch('https://casaaustin.pe/api/landing-precios.php?' + new URLSearchParams({
                    ...dataPosterior,
                    _t: Date.now()
                }));
                const respPosterior = await responsePosterior.json();
                
                if (respPosterior.estadoDisponibilidad === 1) {
                    const preciosPosterior = respPosterior.message2 ? respPosterior.message2.trim() : "";
                    const preciosConvertidos = preciosPosterior.replace(/\$(\d+)\s*USD/g, (match, precioUSD) => {
                        const precioSoles = Math.round(parseInt(precioUSD) * tipoCambio);
                        return `Casa ${precioUSD === '65' ? '1' : precioUSD === '85' ? '2' : '3'}: $${precioUSD} Dólares ó S/.${precioSoles}.00 Soles`;
                    });
                    
                    alternativas.push({
                        fechaInicio: fechaPosteriorInicio,
                        fechaFin: fechaPosteriorFin,
                        precios: preciosConvertidos,
                        tipo: 'posterior'
                    });
                }
                
                // Generar mensaje con alternativas
                let mensajeAlternativas = `📅 *Consulta de Disponibilidad*\n📅 *Del ${moment(fechaInicio).format('dddd D')} al ${moment(fechaFin).format('dddd D [de] MMMM')}* (${numeroNoches} ${numeroNoches === 1 ? 'noche' : 'noches'})\n\n⚠️ *Estas fechas no están disponibles*\n\n`;
                
                if (alternativas.length > 0) {
                    // Ordenar alternativas por fecha
                    alternativas.sort((a, b) => moment(a.fechaInicio).diff(moment(b.fechaInicio)));
                    
                    const alternativasFormateadas = alternativas.map(alt => {
                        const fechaInicioFormateada = moment(alt.fechaInicio).format('dddd D');
                        const fechaFinFormateada = moment(alt.fechaFin).format('dddd D [de] MMMM');
                        const enlace = `https://casaaustin.pe/disponibilidad?checkIn=${alt.fechaInicio}&checkOut=${alt.fechaFin}`;
                        
                        return `✅ *${fechaInicioFormateada} al ${fechaFinFormateada}* - DISPONIBLE\n${alt.precios}\n\n${enlace}`;
                    });
                    
                    mensajeAlternativas += `🎁 *¡Tenemos fechas alternativas disponibles!*\n\n${alternativasFormateadas.join('\n\n')}\n\n💬 *¿Prefieres otras fechas? Responde este mensaje y te ofrecemos un descuento especial para fechas personalizadas.*`;
                } else {
                    mensajeAlternativas += `😔 *Lamentablemente tampoco tenemos disponibilidad para fechas cercanas*\n\n🎁 *¡Pero tenemos una oferta especial para ti!*\n• Responde este mensaje y te ofrecemos un descuento especial\n• Fechas personalizadas con precios preferenciales\n• Atención directa para encontrar la mejor opción\n\n📱 *Contáctanos para más opciones:* ${fotosLink}`;
                }
                
                $('#resultadoContainer').show();
                $('#btnCopiarFlotante').show();
                $('#textoResultado').val(mensajeAlternativas);
                
            } catch (error) {
                console.error('Error verificando fechas alternativas:', error);
                // Mostrar mensaje de error simple
                const mensajeError = `📅 *Consulta de Disponibilidad*\n📅 *Del ${moment(fechaInicio).format('dddd D')} al ${moment(fechaFin).format('dddd D [de] MMMM')}*\n\n⚠️ *Estas fechas no están disponibles*\n\n📱 *Contáctanos para más opciones:* ${fotosLink}`;
                $('#resultadoContainer').show();
                $('#btnCopiarFlotante').show();
                $('#textoResultado').val(mensajeError);
            }
        }

        function copiarResultado() {
            const resultadoTexto = $('#textoResultado');
            const copiarBtn = $('#btnCopiar');
            const copiarBtnFlotante = $('#btnCopiarFlotante');
            
            resultadoTexto.select();
            document.execCommand('copy');
            
            // Efecto en botón principal
            copiarBtn.addClass('copiado');
            copiarBtn.text('¡Copiado!');
            
            // Efecto en botón flotante
            copiarBtnFlotante.addClass('copiado');
            
            setTimeout(function () {
                copiarBtn.removeClass('copiado');
                copiarBtn.text('Copiar Resultado');
                copiarBtnFlotante.removeClass('copiado');
            }, 2000);
        }
    </script>
</body>
</html>
